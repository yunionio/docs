---
title: "虚拟机"
weight: 1
description: 虚拟机是采用虚拟化技术构建的运行在宿主机上的虚拟机实例。
---

虚拟机是采用虚拟化技术构建的运行在宿主机上的虚拟机实例，包括CPU、内存、操作系统、硬盘、网卡等完整的虚拟硬件基础环境。

**虚拟机来源**：

- 当云管平台对接其他平台云账号后，将会自动同步其他平台上的虚拟机到云管平台上进行管理。
- 新建虚拟机。

**入口**：在云管平台单击左上角![](../../../images/intro/nav.png)导航菜单，在弹出的左侧菜单栏中单击 **_"主机/主机/虚拟机"_** 菜单项，进入虚拟机页面。

![](../../../images/computing/VMware1.png)

- 列表右上方将显示虚拟机总数以及处于运行、关机、操作失败以及未知状态的虚拟机数量。

    ![](../../../images/computing/statistics.png)

- 项目视图下，用户无法看到属于域资源的列表参数，如用户在项目视图下看不到虚拟机所属的宿主机或使用的云账号。

## 新建虚拟机

该功能支持在本地IDC、私有云或公有云平台上创建一个或多个虚拟机。若平台中启用了主机申请流程，用户在配置新建虚拟机参数后，将发起主机申请的工单申请，等待工单审核完成后，才会开始自动部署虚拟机。若平台未启用主机申请流程，可直接新建虚拟机。

### 前提条件

- 本地IDC：要求基础资源中存在启用状态的{{<oem_name>}}平台宿主机，或云管平台已对接VMware平台，基础资源中存在启用状态的VMware平台的宿主机。
- 私有云：要求云管平台已导入OpenStack、ZStack、DStack或HCSO云账号的资源，基础资源中存在启用状态的属于上述平台的宿主机，且对应平台有可用IP子网。
- 公有云：要求云管平台已导入阿里云、AWS、Azure、华为云、腾讯云或UCloud云账号的资源，云账号已启用且状态正常，且对应平台有可用IP子网。

### 操作入口

- 创建本地IDC虚拟机：在虚拟机页面，单击列表上方 **_"新建"_** 按钮，进入新建本地IDC虚拟机页面。
- 创建私有云虚拟机：在虚拟机页面，单击顶部“私有云”页签，单击列表上方 **_"新建"_** 按钮，进入新建私有云虚拟机页面。
- 创建公有云虚拟机：在虚拟机页面，单击顶部“公有云”页签，单击列表上方 **_"新建"_** 按钮，进入新建公有云虚拟机页面。

{{% alert title="说明" %}}

在新建任意平台虚拟机页面，都可单击顶部“本地IDC”、“私有云”、“公有云”页签，分别创建不同平台上的虚拟机。
{{% /alert %}}

### 参数配置

{{% alert title="说明" %}}

- 在本地IDC上创建虚拟机时，可直接选择虚拟机所属的平台（{{<oem_name>}}或VMware）。
- 在私有云平台上创建虚拟机时，需要通过区域确定虚拟机所属的平台（OpenStack、ZStack、DStack或HCSO）。
- 在公有云平台上创建虚拟机时，需要通过平台和区域的参数确定虚拟机所属的平台（阿里云、AWS、Azure、华为云、腾讯云、UCloud）。

{{% /alert %}}

- 指定项目：管理员和域管理员在新建虚拟机时需要指定虚拟机所属的项目。
- 区域（本地IDC、私有云）：选择区域和可用区。创建私有云平台虚拟机时需要通过区域确定虚拟机所属的平台。
- 名称：设置虚拟机的名称。
    - 当设置虚拟机数量大于1时，除第一台虚拟机名称外，其他虚拟机名称都以名称-1~N表示。
    - 虚拟机和裸金属共用名称空间。名称在系统中唯一。在项目中创建虚拟机报名称重复错误的原因为其他项目中已存在该名称的虚拟机或裸金属。
    - 名称支持有序后缀占位符#，一个#占一个位置，如名称设置为host##，虚拟机数量为2，创建的虚拟机名称为host00和host01。后续创建虚拟机名称仍设置为host##，名称将沿用之前的排序，编号依次往后。
    - 名称支持表达式，表达式格式为：${变量}，如${host}，则虚拟机名称显示为创建虚拟机的宿主机的名称。详细说明请参考[主机名表达式举例说明](#主机名表达式举例说明)。
- 备注：设置虚拟机备注。
- 计费方式（公有云）：包括按量付费、包年包月。
    - 按量付费：按虚拟机的实际使用量付费，此模式适用于设备需求量会瞬间大幅度增大的场景，价格对比包年包月要贵。
    - 包年包月：是一种预付费的模式，提前一次性支付一个月、一年乃至多年的费用，该模式适用于设备需求比较平稳的场景，价格相对按量付费更便宜。支持勾选自动续费。
{{% alert title="注意" color="warning" %}}
- 仅国内公有云支持包年包月计费方式。
- 仅阿里云包年包月支持购买一周，当选择一周时，平台将自动选择阿里云。
- 阿里云平台按周购买的虚拟机续费周期是一周，按月购买的虚拟机续费周期是一个月，按年购买的虚拟机续费周期是一年；其他平台续费周期均为一个月。后续虚拟机在每次到期之前都会自动续费。
{{% /alert %}}
- 到期释放：设置新建虚拟机到期释放前的使用时长，超过设置的时间后虚拟机将会被删除放入回收站。默认不设置到期释放，用户可根据需要设置“1小时”、“6小时”、“1天”、“3天”、“1周”、“1月”或自定义使用时长。
{{% alert title="注意" color="warning" %}}
- 公有云仅按量付费的虚拟机支持到期释放功能。
- 公有云虚拟机放入回收站后仍然收费，如虚拟机不再使用，请在回收站进行清除。
{{% /alert %}}
- 数量：设置创建虚拟机的数量。
- 平台（本地IDC）：选择虚拟机所属的平台，包括{{<oem_name>}}和VMware。
- 平台及区域（公有云）：可通过地域、平台、区域、可用区确定用户可选套餐，建议选择最靠近的地域，可以降低访问时延，提高访问速度。
{{% alert title="说明" %}}
当创建公有云平台的虚拟机选择地域后，可选平台和区域需要同时满足以下条件：

- 有对应平台的云账号，且云账号未被禁用且余额充足；
- 有对应平台区域的VPC和IP子网；
{{% /alert %}}
- 指定云订阅（公有云）：将使用指定的云订阅在公有云平台上创建虚拟机。将根据云订阅过滤镜像、VPC和IP子网等。
- CPU架构：目前支持x86和ARM架构。仅{{<oem_name>}}平台支持ARM架构，其他平台默认只支持x86架构。
- 是否配置GPU：是否为虚拟机配置GPU卡，启用该项后，还需要选择具体GPU卡。
- CPU核数、内存：设置虚拟机的规格。并可以根据虚拟机规格等选择可用套餐。
- 套餐：虚拟机套餐为虚拟机CPU、内存规格的组合搭配，不同套餐价格不同。若CPU核数、内存规格选择不限，会展示所有的套餐。其中本地IDC和私有云套餐可通过云管平台进行维护，用户创建私有云平台的虚拟机时可以选择本地IDC的套餐或私有云平台的套餐。公有云套餐信息同步对应公有云平台上信息。
{{% alert title="注意" color="warning" %}}
目前已通过套餐中的CPU架构过滤操作系统镜像。
{{% /alert %}}
- 操作系统：选择虚拟机的镜像，支持从以下方式获取镜像。镜像下拉列表中包括镜像名称、大小、CPU架构、分区方式、引导方式，并支持选中的镜像引导方式自动选择下面的引导方式。
    - 公有云镜像：显示对应公有云平台上的公共镜像，仅公有云平台支持，不在镜像列表中显示。
    - 公有云自定义镜像：支持选择对应公有云平台指定云账号上的自定义镜像，仅公有云平台支持，不在镜像列表中显示。
    - 私有云镜像：显示对应私有云平台上的镜像，仅私有云平台支持。不在镜像列表中显示。
    - VMware平台镜像：支持选择VMware平台上指定VMware账户的镜像，仅VMware平台支持。不在镜像列表中显示。
    - 公共镜像：对应系统镜像列表中的公共镜像，一般为系统常用镜像，由管理员维护。
    - 自定义镜像：对应系统镜像列表中的自定义镜像，一般是由用户上传。
    - 从ISO启动：对应系统镜像列表中的ISO格式的镜像。选择ISO镜像文件时，需要用户为虚拟机安装操作系统。仅{{<oem_name>}}和VMware平台支持。
    - 主机镜像：对应主机镜像列表中的主机镜像，仅{{<oem_name>}}平台支持。
    - 主机快照：对应主机快照列表中的主机快照，仅{{<oem_name>}}和VMware平台支持。
{{% alert title="说明" %}}
- 当在公有云平台创建虚拟机时使用云管平台上的公共镜像和自定义镜像，由于需要向公有云平台缓存镜像，创建时间可能会较长，建议使用已缓存镜像。已缓存镜像在镜像名称右侧有已缓存标志。
- 通过挂载ISO安装Windows操作系统的虚拟机，安装完成后，还需要安装Virtio驱动，驱动可在镜像市场-ISO中获取。
{{% /alert %}}
- 监控agent：安装监控agent后支持对CPU、内存、磁盘等指标的详细监控。
{{% alert title="注意" color="warning" %}}
仅{{<oem_name>}}平台支持安装监控agent插件。
{{% /alert %}}
- 系统盘：根据选择的套餐情况显示并设置不同的磁盘类型、介质以及磁盘的容量大小。公有云平台不支持设置调度标签
{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台的系统盘支持查看磁盘对应的介质。
- 当在VMware平台创建虚拟机选择VMware平台镜像或主机快照时，系统盘大小不支持调整大小。
- 当在OpenStack平台创建虚拟机时，支持以镜像为系统盘，镜像存储为系统盘存储。
- 公有云平台不支持设置调度标签。
- 当在腾讯云平台创建虚拟机时，系统盘大小必须为10的倍数。否则会创建失败。
- 当操作系统选择”从ISO启动“时，虚拟机上的磁盘类型都显示为数据盘。磁盘类型显示不影响虚拟机的正常使用。
- 设置系统盘时，系统将会自动检查所选磁盘类型对应的存储容量是否满足需求。
    - 当对应存储剩余容量小于100GB时，将会黄框提醒用户。此时仍可以成功创建磁盘，但是建议用户创建完成后去[存储-块存储](../../../storage/block)页面增加新存储或调整存储容量。
    - 当对应存储剩余容量不能满足设置的系统盘大小时，将显示红框，并提示用户去[存储-块存储](../../../storage/block)页面增加新存储或调整存储容量。
{{% /alert %}}
    - 当不设置调度标签及调度偏好以及指定块存储时，系统将按照调度策略以及调度标签的默认偏好自动为虚拟机选择最优的存储。
        - 优先检查系统中的调度策略，当有符合的调度策略，将根据调度策略中设置的调度标签及调度标签偏好选择对应存储。调度策略中的调度标签偏好会覆盖调度标签中的默认策略。
        - 当没有符合的调度策略后，将根据存储设备中绑定的调度标签的默认策略选择最优存储。
    - 当设置调度标签和调度标签偏好时，设置的调度标签偏好将覆盖调度标签上的默认策略。根据调度偏好以及调度标签选择提供系统盘的存储。
        - 尽量使用（prefer）：调度时优先使用拥有这种标签的存储。
        - 避免使用（avoid）：调度时尽量避免拥有这种标签的存储。
        - 禁止使用（exclude）：调度时排除拥有这种标签的存储。
        - 必须使用（require）：调度时必须使用拥有这种标签的存储。
    - 举例说明：以本地存储为例，本地存储A绑定调度标签A，调度标签A默认策略为尽量使用。本地存储B绑定调度标签B，调度标签B默认策略为禁止使用。调度策略A为当在项目A中创建虚拟机时，选择调度标签B，调度策略偏好为必须使用。
        - 当不设置调度标签时，有以下两种情况。
            - 若虚拟机属于项目A，系统将优先选择本地存储B为虚拟机系统盘提供存储。
            - 当虚拟机不属于项目A，系统将优先选本地存储A为虚拟机系统盘提供存储。
        - 当设置调度标签为A，策略为禁止使用时，系统将会排除本地存储A，选择本地存储B为虚拟机系统盘提供存储。
    - 指定块存储：用户在管理后台视图下支持为磁盘指定块存储，并支持查看存储的使用情况等，目前仅VMware平台支持。
- 数据盘：可选项，可根据需求添加多块数据盘，设置磁盘的类型、介质及容量大小。磁盘可选类型同系统盘。仅第一块数据盘支持选择磁盘类型，后续添加的数据盘类型同第一块数据盘。
{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台的数据盘支持查看磁盘对应的介质。
- 当创建OpenStack虚拟机时当系统盘以镜像为存储时，数据盘类型可以设置。
- VMware平台的数据盘类型与系统盘类型一致。
- 添加的数据盘仅挂载到虚拟机上，不会自动执行分区操作，需要用户远程连接虚拟机后手动分区。
{{% /alert %}}
    - 仅{{<oem_name>}}平台支持支持设置挂载点、快照建磁盘、设置调度标签。私有云如使用本地存储，也支持设置调度标签功能。
      - 设置调度标签：同系统盘。
      - 设置挂载点：设置数据盘的文件类型（ext4、xfs、swap）、数据盘挂载的非系统目录。设置挂载点和快照建磁盘两者只能设置一个。
      - 快照建磁盘：根据快照创建数据盘。可在本地IDC中查看已存在的快照。设置挂载点和快照建磁盘两者只能设置一个。
- 管理员账号：显示虚拟机的管理员账号
- 管理员密码：设置管理员密码，在Linux系统中为root用户的密码，在Windows操作系统中为administrator用户的密码。
  - 随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码
  - 关联密钥：在关联密钥之前需要先新建密钥。关联密钥后，用户需要使用私钥远程登录虚拟机。
  - 保留镜像设置：管理员密码为镜像中已有的管理员密码。
  - 手工输入：可手动设置管理员密码。
{{% alert title="说明" %}}
- 当选择从ISO启动时，不支持设置管理员密码，管理员密码需要在用户安装操作系统时进行设置。
- 根据虚拟机所在平台不同，设置管理员密码的方式可能为以上方式的其中几种，请以界面为准。
{{% /alert %}}
- 网络：设置虚拟机的IP地址。
{{% alert title="注意" color="warning" %}}
- VMware虚拟机不支持VPC网络，仅可以选择default经典网络。
- 仅{{<oem_name>}}虚拟机可以选择default经典网络和VPC网络。
- 只有{{<oem_name>}}平台虚拟机支持最多添加8个网络，其他平台仅支持一个网络。
{{% /alert %}}
  - 自动调度：当选择自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。
  - 指定IP子网：选择VPC和IP子网，如需指定静态IP，可单击 **_"手动配置IP"_** 按钮，设置IP地址，单击 **_"确定"_** 按钮。
  - 指定调度标签：设置调度标签以及调度标签偏好。设置的调度标签偏好将会覆盖调度标签上的默认策略。根据调度标签及调度偏好选择最优的IP子网。
      - 尽量使用（prefer）：调度时优先使用拥有这种标签的IP子网。
      - 避免使用（avoid）：调度时尽量避免拥有这种标签的IP子网。
      - 禁止使用（exclude）：调度时排除拥有这种标签的IP子网。
      - 必须使用（require）：调度时必须使用拥有这种标签的IP子网。
  - 举例说明：如IP子网A绑定调度标签A，默认策略为禁止使用。IP子网B绑定调度标签B，默认策略为尽量使用。调度策略A为当虚拟机属于项目A，选择调度标签A，调度标签偏好为必须使用。
      - 当创建虚拟机时网络选择默认时，有以下两种情况。
          - 当虚拟机属于项目A时，系统将选择IP子网A为虚拟机分配IP地址。
          - 当虚拟机不属于项目A时，系统将选择IP子网B为虚拟机分配IP地址。
      - 当创建虚拟机时网络选择指定IP子网A，系统将选择IP子网A为虚拟机分配IP地址。
      - 当创建虚拟机时网络选择调度标签A，且标签偏好为必须使用，则系统会从IP子网A中为虚拟机分配一个未使用的IP地址。
- 标签：支持为新建的虚拟机绑定标签。支持选择已有标签和新建标签。
    - 新建标签：单击列表上方 **_新建_** 按钮，设置标签键和标签值，单击 **_"添加"_** 按钮，新建标签并绑定到资源上。
    - 选择已有标签：单击 **_"已有标签"_** 按钮，选择标签键和值。

**高级配置**：默认隐藏，可根据需求进行配置。

- 弹性公网IP：弹性公网IP是一种NAT IP，通过与虚拟机绑定，实现虚拟机与公网之间的通信。默认为暂不绑定，当选择“新建”时，需要配置以下参数：
    - 线路类型：可根据需求创建对应线路类型的EIP。
    - 网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
        - 按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。
        - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
    - 带宽：设置带宽大小。
- 公网IP：公网IP通过与虚拟机绑定，实现虚拟机与公网之间的通信。包含弹性公网IP和静态公网IP，弹性公网IP可以灵活与虚拟机绑定或解绑。静态公网IP则不支持与虚拟机解绑。默认为暂不绑定。当选择“新建弹性公网IP”或新建静态公网IP时，需要配置以下参数：
    - 网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
        - 按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。
        - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
    - 带宽：设置带宽大小。
{{% alert title="注意" color="warning" %}}
- 本地IDC平台创建VPC网络的虚拟机时支持绑定弹性公网IP，且仅支持按带宽计费；
- 除腾讯云、阿里云外的公有云平台新建虚拟机时仅支持新建弹性公网IP，腾讯云和阿里云平台新建虚拟机时支持新建弹性公网IP和静态公网IP。
- 创建AWS虚拟机时，若选择的VPC不允许外网访问，则不允许新建弹性公网IP。
- AWS、Azure、Google只支持按流量计费。
{{% /alert %}}
- 安全组：为虚拟机设置安全组规则，安全组是一种虚拟的包过滤防火墙，通过设置安全组规则来控制关联的虚拟机是否可以被访问，以及虚拟机可访问的外部资源等。一个虚拟机最多支持绑定5个安全组。
- 调度策略：通过调度策略可以选择虚拟机所属的宿主机或云账号。
  - 默认：系统将根据调度策略以及调度标签为虚拟机选择最优的宿主机。
      - 优先检查系统中的调度策略，如有符合的调度策略，将根据调度策略中的调度标签及调度标签偏好选择最优的宿主机。调度策略中的调度标签偏好会覆盖调度标签中的默认策略。
      - 当没有符合的调度策略，系统将根据宿主机绑定的调度标签的默认策略来选择最优的宿主机。
  - 指定宿主机：虚拟机将在指定的宿主机上创建。
  - 指定调度标签：设置调度标签以及调度标签的偏好。设置的调度标签偏好将会覆盖调度标签的默认策略。根据调度标签及调度标签偏好选择对应的宿主机。
      - 尽量使用（prefer）：调度时优先使用拥有这种标签的宿主机。
      - 避免使用（avoid）：调度时尽量避免拥有这种标签的宿主机。
      - 禁止使用（exclude）：调度时排除拥有这种标签的宿主机。
      - 必须使用（require）：调度时必须使用拥有这种标签的宿主机。
  - 举例说明：如宿主机A绑定调度标签A，调度标签A的策略为禁止使用。宿主机B绑定调度标签B，调度标签B的策略为尽量使用。调度策略A为当在项目A中创建虚拟机时，选择调度标签A，调度策略偏好为必须使用。
      - 当创建虚拟机时调度策略选择默认时，有以下两种情况。
          - 当虚拟机属于项目A时，系统将选择在宿主机A上创建虚拟机。
          - 当虚拟机不属于项目A时，系统将选择宿主机B上创建虚拟机。
      - 当选择调度标签A，且设置调度标签偏好为必须使用时，系统将选择在宿主机A上创建虚拟机。
  - 指定云订阅（本地IDC和私有云）：将使用指定的云订阅在私有云平台或VMware平台上创建虚拟机。若在配置网络时指定IP子网，则只能选择IP子网所在的云订阅。
- 引导方式：包括BIOS和UEFI模式，仅{{<oem_name>}}平台支持，且ARM架构仅支持UEFI模式。
- 远程终端协议：包括VNC和SPICE，仅{{<oem_name>}}平台支持。
    - VNC：主要用于linux的服务器的管理，由于无声音和usb传输，不满足于虚拟桌面的使用。
    - SPICE：在色彩、音频和usb方面等表现较好，适用于虚拟桌面。
- 显卡型号：包括Standard和QXL，当远程终端协议选择VNC时，显卡型号可设置为Standard和QXL，当远程终端协议为SPICE时，显卡型号仅可设置为QXL，仅{{<oem_name>}}平台支持。
- 主机型号：包括PC和Q35，仅{{<oem_name>}}平台支持。
- 备份机：仅{{<oem_name>}}平台支持且要求虚拟机所在域或共享给虚拟机所在域使用的宿主机不低于2台，通过为虚拟机创建备份机来实现高可用，虚拟机与备份机之间定时同步数据，当虚拟机故障时，业务将切换到备份机上正常使用。可以快速恢复业务，减少因为虚拟机故障造成的业务宕机时间。当启用高可用功能时，需要指定备份机的宿主机。
- 反亲和组：选择是否勾选反亲和组，若勾选，则需要选择反亲和组，新创建的虚拟机需要根据反亲和组内的调度规则选择宿主机等，若不满足调度规则，则可能创建失败，仅{{<oem_name>}}平台支持。

设置完成后，用户可单击 **_新建_** 按钮，创建虚拟机。

若启用了工单，则需要填入申请原因，单击 **_"提交工单"_** 按钮，提交创建虚拟机的工单，等待审批通过后才会开始创建虚拟机。

#### 主机名表达式举例说明

主机（包括虚拟机和裸金属）名称支持表达式，表达式格式为：${变量名}，变量名需要小写。如${host}，则虚拟机名称显示为创建虚拟机的宿主机的名称；${region}-${zone}，则显示为区域名-可用区名称等。

支持的变量名如下：

变量名| 举例| 说明
---------|----------|---------
 brand | aliyun | 品牌
 charge_type | postpaid | 计费方式
 cloud_env | onpremise/public/private | 用于区分本地IDC、私有云和公有云平台
 cloudregion_id | default | 区域id
 cpu | 1 | CPU数量
 host | gobuild | 主机名
 host_id | 16f49f8a-88cc-4715-8870-f78130196fa9| 主机id
 ip_addr | 192.168.1.1 | IP地址
 mem | 1024 | 内存
 os_distribution	 | 操作系统 | CentOS
 os_type | Linux | 操作系统类型
 os_version | 6.9 | 操作系统版本
 owner_tenant	 | system | 项目
 owner_tenant_id | d56f5c37e36a42b782d7f32b19497c4c | 项目id
 provider | OpenStack | 提供方
 region | Default | 区域
 region_id | kvm | 虚拟化方式
 res_name | server | 资源类别
 template_id | 5199f56b-01c2-425c-8e29-0179d283e4a3| 模板id
 zone | zone1 | 可用区
 zone_id | 00f3f3c6-1d16-4053-81f1-4cb092f418f5| 可用区id

## 虚拟机操作

虚拟机支持多种操作，不同平台对虚拟机操作要求限制不同。

| 操作\平台       | {{<oem_name>}} | VMware    | OpenStack  | ZStack   | DStack   | HCSO       | 阿里云      | AWS      | Azure    | 华为云        | 腾讯云      | UCloud   | Google   | 天翼云      |
|-------------|----------------|-----------|------------|----------|----------|------------|----------|----------|----------|------------|----------|----------|----------|----------|
| VNC登录       | 运行             | 运行        | 运行         | 运行       | 运行       | 运行         | 运行       | 不支持      | 不支持      | 运行         | 运行       | 运行       | 不支持      | 不支持      |
| WEB SSH登录   | 所有IP、运行        | 所有IP、运行   | 支持EIP、运行   | 支持EIP、运行 | 支持EIP、运行 | 支持EIP、运行   | 支持EIP、运行 | 支持EIP、运行 | 支持EIP、运行 | 支持EIP、运行   | 支持EIP、运行 | 支持EIP、运行 | 支持EIP、运行 | 支持EIP、运行 |
| 重装系统        | 运行、关机          | 运行、关机     | 关机         | 关机       | 关机       | 关机、故障      | 运行、关机    | 运行、关机    | 运行、关机    | 关机、故障      | 运行、关机    | 关机       | 关机       | 关机       |
| 调整配置        | 运行、关机          | 关机        | 关机         | 运行、关机    | 运行、关机    | 关机         | 关机       | 关机       | 运行、关机    | 关机         | 关机       | 关机       | 关机       | 关机       |
| 创建快照        | 支持             | 仅支持创建主机快照 | 支持         | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持         | 支持       | 不支持      | 支持       | 支持       |
| 创建相同配置      | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 支持         | 支持       | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持       |
| 绑定GPU卡      | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 设置磁盘速度      | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 到期释放        | 支持             | 支持        | 支持         | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持       |
| 主机克隆        | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 续费          | 不支持            | 不支持       | 不支持        | 不支持      | 不支持      | 支持         | 不支持      | 不支持      | 不支持      | 支持         | 支持       | 支持       | 不支持      | 不支持      |
| 自动续费设置      | 不支持            | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 支持       | 不支持      | 不支持      | 支持         | 支持       | 支持       | 不支持      | 不支持      |
| 重置密码        | 关机             | 关机        | 运行         | 运行       | 运行       | 关机         | 关机       | 不支持      | 运行       | 关机         | 关机       | 运行       | 关机       | 关机       |
| 绑定/解绑密钥     | 关机             | 关机        | 仅新建时支持绑定密钥 | 运行       | 运行       | 仅新建时支持绑定密钥 | 关机       | 不支持      | 运行       | 仅新建时支持绑定密钥 | 关机       | -        | 关机       | 不支持      |
| 保存镜像        | 支持             | 支持        | 不支持        | 不支持      | 不支持      | 支持         | 支持       | 支持       | 支持       | 支持         | 支持       | 不支持      | 支持       | 不支持      |
| 挂载/卸载ISO    | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 关联安全组（个数）   | 5              | 不支持       | 5          | 1        | 1        | 5          | 5        | 5        | 1        | 5          | 5        | 1        | 5        | 5        |
| 绑定/解绑弹性公网IP | 仅VPC网络支持       | 不支持       | 支持         | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持       |
| 公网IP转EIP    | 不支持            | 不支持       | 不支持        | 不支持      | 不支持       | 不支持        | 支持       | 支持       | 支持       | 支持         | 支持       | 支持       | 支持       | 支持       |
| 设置源/目标检查    | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 备份机         | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |
| 迁移          | 支持             | 不支持       | 不支持        | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持        | 不支持      | 不支持      | 不支持      | 不支持      |

### 远程控制

通过VNC远程终端或Web SSH远程连接到虚拟机。
{{% alert title="注意" color="warning" %}}
- AWS、Azure、Google、天翼云不支持VNC远程终端；
- Windows操作系统的虚拟机只支持通过VNC远程终端；
- ZStack、DStack、HCSO、阿里云、AWS、Azure、华为云、腾讯云、UCloud需要虚拟机上存在EIP才可以通过Web SSH远程连接。
- {{<oem_name>}}平台经典网络的虚拟机可以直接使用Web SSH和VNC远程终端；{{<oem_name>}}平台VPC网络的虚拟机可以直接使用Web SSH和VNC远程终端，也可以绑定EIP后使用EIP的Web SSH。请注意，未绑定EIP的VPC网络的虚拟机只能通过平台的Web SSH连接，无法使用SSH工具进行连接，如需使用SSH工具连接虚拟机，请为虚拟机绑定EIP。
- 当VMware的虚拟机所在EXSI低于6.5版本时，无法直接打开VNC远程终端，需要用户在本地下载vmrc（VMware Remote Console）客户端。
- VNC长时间连接黑屏后，按空格键会恢复显示。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列操作列 **_"远程终端"_** 按钮，选择 **_"VNC远程终端"_** 菜单项，新建Web Console名称的浏览器标签页。

    ![](../../../images/computing/console1.png)

  - 发送远程命令：单击 **_"发送远程命令"_** 按钮，选择下拉菜单 **_"Ctrl-Alt-F1~F12"_** 菜单项，向虚拟机控制台发送具体的命令。
  - Ctrl-Alt-Delete：单击\ **_Ctrl-Alt-Delete_** 按钮，若虚拟机为Windows系统，则向虚拟机控制台发送Ctrl-Alt-Delete命令，若虚拟机为Linux系统，则将弹出重启服务器提示，单击 **_"确定"_** 按钮后将重启虚拟机。
  - 发送文字：单击 **_发送文字_** 按钮，在弹出的发送文字对话框中输入需要发送的内容，单击 **_"确定"_** 按钮，向虚拟机控制台发送文字，如发送内容为登录密码，在发送文字后，需要键入回车键确认登录。
2. 单击 **_"远程终端"_** 按钮，选择 **_"SSH IP地址"_** 菜单项，与虚拟机建立web SSH连接。
3. 单击 **_远程终端_** 按钮，选择 **_"SSH IP地址:任意端口"_** 菜单项，在弹出的对话框中设置端口号，单击 **_"确定"_** 按钮，与虚拟机建立web SSH连接。

    ![](../../../images/computing/sshconsole1.png)

### 实例状态

#### 开机
该功能用于将处于关机状态的虚拟机开机。批量开机操作支持选择不同平台上“关机”状态的虚拟机。

**单个虚拟机开机**

1. 在虚拟机页面，单击“关机”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-开机"_** 菜单项，启动虚拟机。

**批量开机**

1. 在虚拟机列表中选择一个或多个“关机”状态的虚拟机，单击列表上方 **_"开机"_** 按钮，批量启动多个虚拟机。

#### 关机
该功能用于将处于运行中状态的虚拟机关机。批量关机操作支持选择不同平台上“运行中”状态的虚拟机。

{{% alert title="注意" color="warning" %}}
目前仅阿里云、腾讯云按量付费的虚拟机支持关机不收费。

- 关机后，将释放CPU、内存，并停止对CPU、内存的计费，所关联硬盘、镜像、公网带宽(如需计费)依然计费
- 关机后，实例的 CPU 、内存将不再保留，所以再次启动实例时可能会失败。此时，您可以尝试再次启动，或者换一个时间再次启动
- 关机后，普通公网 IP 将被释放不可找回，建议您先转换为弹性公网 IP 后再进行关机操作
- 关机后，弹性公网 IP 将被保留，不会被释放，关机期间也不收取费用
- 关机期间实例较多操作（如调整配置、重装系统等）可能无法支持，如需操作请开机后进行
- 部分不支持关机不收费的实例，关机后继续正常收费
{{% /alert %}}

**单个虚拟机关机**

1. 在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-关机"_** 菜单项，弹出操作确认对话框。
2. 当虚拟机是阿里云或腾讯云平台上按量付费的虚拟机时，可以选择勾选“关机不收费”。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量关机**

1. 在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 **_"关机"_** 按钮，弹出操作确认对话框。
2. 当被选择的虚拟机是阿里云或腾讯云平台上按量付费的虚拟机时，可以选择勾选“关机不收费”。
3. 单击 **_"确定"_** 按钮，完成操作。 

#### 重启
该功能用于将处于运行中状态的虚拟机重启，重启过程中VNC连接会中断。批量重启操作支持选择不同平台上“运行中”状态的虚拟机。

**单个虚拟机重启**

1. 在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-重启"_** 菜单项，弹出操作确认对话框。
2. 选择是否勾选强制重启，单击 **_"确定"_** 按钮。

**批量重启**

1. 在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 **_"重启"_** 按钮，弹出操作确认对话框。
2. 选择是否勾选强制重启，单击 **_"确定"_** 按钮。

{{% alert title="注意" color="warning" %}}
若勾选“强制重启”，虚拟机中未保存数据将会丢失。
{{% /alert %}}


#### 重置

该功能用于将运行中状态的虚拟机重启，重启过程中VNC连接不会中断。仅支持{{<oem_name>}}平台上的虚拟机。

1. 在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-重置"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

#### 挂起

该功能用于将运行中状态的虚拟机进入休眠状态，挂起状态下虚拟机会保存当前状态，服务将处于暂停状态而不会结束，可通过恢复功能快速恢复状态。

目前仅VMware虚拟机支持挂起/恢复操作。

**单个虚拟机挂起**

1. 在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-挂起"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量挂起**

1. 在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"挂起"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

#### 恢复

该功能用于将挂起状态的虚拟机恢复成运行状态。

目前仅VMware虚拟机支持挂起/恢复操作。

**单个虚拟机恢复**

1. 在虚拟机页面，单击“挂起”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-恢复"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

**批量恢复**

1. 在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"恢复"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

#### 同步状态

当虚拟机被恶意破坏或经非法暴力操作，导致服务状态异常（如系统死机），需要管理员后台修复，同步虚拟机环境状态，提供系统级服务修复措施。或者在资源超配情况下，同步运行状态。批量同步状态操作支持选择不同平台上的虚拟机。

**单个同步状态**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例状态-同步状态"_** 菜单项，同步虚拟机状态。

**批量同步状态**

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"同步状态"_** 菜单项，同步虚拟机状态。

### 实例设置

#### 修改属性

该功能用于修改虚拟机的启动介质、引导方式等。

**单个虚拟机修改属性**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-修改属性"_** 菜单项，弹出修改属性对话框。
2. 修改虚拟机是否启用删除保护，禁用删除保护后，可删除虚拟机。启用删除保护后，无法删除虚拟机。
3. 修改虚拟机的启动介质，选择从硬盘、光驱、网络启动虚拟机。
    - 如挂载ISO后，可选择从光驱启动虚拟机，并进行安装操作系统的操作。
    - 如系统盘已有操作系统，可选择通过硬盘启动虚拟机等。
    - 如设备需要通过网络从远端服务器下载镜像启动，则需要选择通过网络启动虚拟机。
3. 修改虚拟机的引导方式，目前仅{{<oem_name>}}平台上虚拟机支持修改，且ARM架构只支持UEFI引导方式。
4. 单击 **_"确定"_** 按钮，完成操作。

**批量修改属性**

1. 在虚拟机列表中选择一个或多个虚拟机，单击 **_"批量操作"_** 按钮，选择下拉菜单 **_"修改属性"_** 菜单项，弹出修改属性对话框。
2. 修改虚拟机的启动介质，选择从硬盘、光驱、网络启动虚拟机。
    - 如挂载ISO后，可选择从光驱启动虚拟机，并进行安装操作系统的操作。
    - 如系统盘已有操作系统，可选择通过硬盘启动虚拟机等。
    - 如设备需要通过网络从远端服务器下载镜像启动，则需要选择通过网络启动虚拟机。
3. 修改虚拟机的引导方式，目前仅{{<oem_name>}}平台上虚拟机支持修改，且ARM架构只支持UEFI引导方式。
4. 单击 **_"确定"_** 按钮，完成操作。

#### 重装系统

该功能用于为虚拟机更换系统。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-重装系统"_** 菜单项，弹出重装系统对话框。
2. 选择系统镜像，可分别从公共镜像或自定义镜像中选择同操作系统的镜像。
3. 设置管理员密码，在Linux系统中为root用户的密码，在Windows操作系统中为administrator用户的密码。

    - 随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。
    - 关联密钥：在关联密钥之前需要先新建密钥。关联密钥后，用户需要使用私钥远程登录虚拟机。
    - 保留镜像设置：管理员密码为镜像中已有的管理员密码。
    - 手工输入：可手动设置管理员密码。

{{% alert title="说明" %}}
根据虚拟机所在平台不同，设置管理员密码的方式可能为以上方式的其中几种，请以界面为准。
{{% /alert %}}

4. 默认勾选“重装系统后自动启动”，可根据需要取消勾选，单击 **_"确定"_** 按钮，完成操作。

#### 调整配置

该功能用于修改虚拟机的硬件配置，包括CPU、内存以及硬盘大小等，支持批量操作。

{{% alert title="注意" color="warning" %}}

- 在{{<oem_name>}}平台虚拟机运行状态下CPU和内存大小只允许往上调整；
- ZStack在虚拟机开机状态下不允许调整CPU和内存大小，只支持增加数据盘。
- 阿里云的虚拟机在绑定EIP之后不允许调整虚拟机配置。
- 除阿里云、腾讯云、华为云之外的平台包年包月的虚拟机不支持调整配置。
- 批量调整配置时，仅允许选择同一个平台上的虚拟机。
{{% /alert %}}

**单个虚拟机调整配置**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-调整配置"_** 菜单项，弹出调整配置对话框。
2. 调整虚拟机的CPU核数、内存以及数据盘，也可根据需求添加新磁盘，若虚拟机在"关机"状态下可勾选“调整配置后自动启动”，单击 **_"确定"_** 按钮。
3. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交调整配置工单，等待审批通过后才会成功调整配置。

**批量调整配置**

1. 在虚拟机列表中选择一个或多个同一个平台的虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"调整配置"_** 菜单项，弹出调整配置对话框。
2. 调整虚拟机的CPU核数、内存，若虚拟机在"关机"状态下可勾选“调整配置后自动启动”，单击 **_"确定"_** 按钮。
3. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交调整配置工单，等待审批通过后才会成功调整配置。
  
#### 更改项目

项目是资源的拥有者，当虚拟机属于某项目后，项目中的所有成员都有权限使用该虚拟机。可根据具体使用需求更改虚拟机所属的项目。

**单个虚拟机更改项目**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-更改项目"_** 菜单项，弹出更改项目对话框。
2. 选择域和域下的项目后，单击 **_"确定"_** 按钮，完成操作。

**批量更改项目**

批量更改项目要求虚拟机属于同一个域。

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"更改项目"_** 菜单项，弹出更改项目对话框。
2. 选择域和域下的项目后，单击 **_"确定"_** 按钮，完成操作。


#### 创建快照

快照是一种数据备份方式，可以在指定时间点对虚拟机的系统盘、数据盘或虚拟机整体创建一个完全可用拷贝，便于虚拟机故障后快速回退到创建快照时的虚拟机状态。

{{% alert title="注意" color="warning" %}}
- 目前UCloud、天翼云平台暂不支持创建快照操作；VMware平台虚拟机仅支持创建主机快照。私有云平台仅支持本地硬盘创建硬盘快照。{{<oem_name>}}平台同时支持创建硬盘快照和主机快照。
- 状态异常的硬盘不支持创建硬盘快照。
- 主机快照占的快照配额数等于主机上的硬盘数，即若主机上有2块硬盘，为该主机创建主机快照所站的快照配额为2。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-创建快照"_** 菜单项，弹出新建快照对话框。
2. 选择快照类别。
    - 当选择快照类别为“创建硬盘快照”，选择需要备份的磁盘，设置快照名称，单击 **_"确定"_** 按钮，创建硬盘快照。
    - 当选择快照类别为“创建主机快照”，设置快照名称，单击 **_"确定"_** 按钮，创建主机快照。

#### 创建备份
该功能用于创建硬盘或主机的备份。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台上虚拟机支持该操作。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-创建备份"_** 菜单项，弹出新建备份对话框。
2. 选择备份类别。
    - 当选择备份类别为“硬盘备份”，选择需要备份的磁盘，设置备份名称，设置备份存储，单击 **_"确定"_** 按钮，创建硬盘备份。
    - 当选择快照类别为“主机备份”，设置备份名称，设置备份存储，单击 **_"确定"_** 按钮，创建主机备份。

#### 创建相同配置
该功能用于创建相同配置的虚拟机。

{{% alert title="注意" color="warning" %}}
- VMware、OpenStack、ZStack、DStack平台上虚拟机不支持该操作。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-创建相同配置"_** 菜单项，弹出创建相同配置对话框。
2. 输入名称，设置数量，单击 **_"确定"_** 按钮。如创建多个虚拟机，第1个创建的虚拟机名称为设置的名称，第2~N个创建的虚拟机名称为名称- 1~N-1。

#### 设置GPU卡

该功能用于设置为虚拟机绑定或解绑GPU卡，绑定GPU卡之前请确保虚拟机所在宿主机上存在GPU透传设备。当虚拟机用于高性能计算、图形显示等用途时，建议绑定GPU卡。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台支持绑定、解绑GPU卡功能。
- 当宿主机上存在空闲的GPU设备时，宿主机上的虚拟机才可以绑定GPU卡。
- 虚拟机关机状态才可以绑定、解绑GPU卡。
- 批量绑定GPU卡操作仅支持关联同种型号的GPU卡，批量解绑会取消所有已关联的GPU卡。
- 目前仅管理员支持设置GPU功能。
{{% /alert %}}

**单个虚拟机设置GPU卡**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-设置GPU卡"_** 菜单项，弹出设置GPU卡对话框。
2. 设置GPU卡页面支持绑定和解绑GPU卡。
    - 绑定GPU卡：勾选是否绑定，并选择GPU卡，支持选择为虚拟机绑定多个GPU卡，默认勾选设置成功后自动启动，即绑定GPU卡后自动启动虚拟机，单击 **_"确定"_** 按钮。
    - 解绑GPU卡：取消勾选是否绑定，取消后，则解绑虚拟机上的所有GPU卡，默认勾选设置成功后自动启动，即解绑GPU卡后自动启动虚拟机，单击 **_"确定"_** 按钮。

**批量为虚拟机设置GPU卡**

1. 在虚拟机列表中选择一个或多个{{<oem_name>}}平台上关机状态的虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置GPU卡"_** 菜单项，弹出设置GPU卡对话框。
2. 设置GPU卡页面支持批量绑定和解绑GPU卡。
    - 绑定GPU卡：设置GPU卡选择“关联GPU卡”，选择GPU卡型号，设置每台虚拟机上绑定的GPU卡数量，默认勾选批量绑定GPU后自动启动，即绑定GPU卡后自动启动虚拟机，单击 **_"确定"_** 按钮。
    - 解绑GPU卡：设置GPU卡选择“解绑GPU卡”，默认勾选批量解绑成功后自动启动，即解绑GPU卡后自动启动虚拟机，单击 **_"确定"_** 按钮，批量解绑GPU卡。

#### 设置USB透传

该功能用于设置为虚拟机关联或解绑多个USB设备。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台上虚拟机支持该操作。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-设置USB透传"_** 菜单项，弹出设置USB透传对话框。
2. 勾选是否绑定，若勾选，设置USB设备。
3. 勾选自动启动开关，若开启，设置成功后自动启动，单击 **_"确定"_** 按钮。

#### 设置磁盘速度

该功能用于限制磁盘的IOPS，其中IOPS是指单位时间内系统能处理的I/O请求数量，I/O请求通常为读或写数据操作请求。仅{{<oem_name>}}平台上运行状态的虚拟机支持该操作。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-设置磁盘速度"_** 菜单项，弹出设置磁盘速度对话框。
2. 勾选是否限速，若勾选，设置磁盘最大IOPS，单击 **_"确定"_** 按钮。

#### 更换块存储

该功能用于更换硬盘块存储，包括本地存储和ceph共享存储。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台上虚拟机支持该操作。
- 只有在虚拟机状态为运行中或关机状态支持该操作。
- 要求迁移存储挂载在同一宿主机。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-更换块存储"_** 菜单项，弹出更换块存储对话框。
2. 选择要更换的块存储，单击 **_"确定"_** 按钮。

#### 绑定物理CPU

该功能用于虚拟机绑定物理CPU。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台上虚拟机支持该操作。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-绑定物理CPU"_** 菜单项，弹出绑定物理CPU对话框。
2. 勾选绑定物理CPU开关，若开启，设置CPU核数后，单击 **_"确定"_** 按钮。

#### 到期释放

到期释放即设置虚拟机的使用时长，当超过设置期限时，虚拟机将会被自动删除，存放到回收站。

{{% alert title="注意" color="warning" %}}
- 公有云仅按量付费的虚拟机支持到期释放功能。
- 公有云虚拟机放入回收站后仍然收费，如虚拟机不再使用，请在回收站进行清除。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-到期释放"_** 菜单项，弹出到期释放对话框。
2. 选择是否勾选到期释放，勾选后设置虚拟机的释放时间，单击 **_"确定"_** 按钮。
    - 单击释放时间输入框，显示日历等内容，支持直接在释放时间输入框中输入日期和时间，格式为yyyy-mm-dd hh:mm:ss，单击 **_"确定"_** 按钮。 
    - 在日历框中选择日期，单击 **_选择时间_** 按钮，将跳转到设置时间界面，选择时间后，单击 **_"确定"_** 按钮。
    - 支持快速选择“1小时”、“2小时”、“3小时”、 “6小时”、 “1天”、“2天”、 “1周”按钮，释放时间将设置为对应时间范围内的时间，单击 **_"确定"_** 按钮。
3. 设置完成后，在计费方式列显示虚拟机还有多久时间释放等信息。
4. 若不再需要到期释放功能，可在虚拟机释放之前，在弹出的到期释放对话框中取消勾选到期释放，单击 **_"确定"_** 按钮。

#### 主机克隆

该功能用于根据虚拟机的规格信息克隆出与当前虚拟机系统、配置相同的虚拟机。仅{{<oem_name>}}平台上的运行和关机状态的虚拟机支持主机克隆功能。

当前主机克隆实现原理是基于主机快照创建新的虚拟机，主机克隆过程中会产生主机快照，并占用快照配额，需要用户及时删除无用快照，若当前用户项目不存在快照配额，则将无法使用主机克隆功能。

**单个克隆**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-主机克隆"_** 菜单项，弹出主机克隆对话框。
2. 设置名称、数量、克隆方式。
    - 新主机快照克隆：当选择“新主机快照克隆”时，建议勾选“克隆完成后删除本次克隆生成的主机快照”，减少无用主机快照，释放快照配额等，单击 **_"确定"_** 按钮，虚拟机在会创建主机快照并创建与当前虚拟机配置完全相同的虚拟机。
    - 已有主机快照克隆：当选择“已有主机快照克隆”时，需要勾选该虚拟机已创建的主机快照，单击 **_"确定"_** 按钮。使用已有的主机快照克隆的虚拟机与创建快照时刻的虚拟机配置和状态相同，与当前虚拟机状态可能不相同。若用户不需要使用已有主机快照，也可以在该页面删除主机快照，增加快照配额。

**批量克隆**

1. 在虚拟机列表中选择两个及以上虚拟机，单击列表上方**_"批量操作"_** 按钮，选择下拉菜单 **_"实例设置-主机克隆"_** 菜单项，弹出主机克隆对话框。
2. 单击 **_"确定"_** 按钮，批量克隆虚拟机。

#### 加入反亲和组

该功能用于将虚拟机加入反亲和组。仅{{<oem_name>}}平台的虚拟机支持加入反亲和组功能。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-加入反亲和组"_** 菜单项，弹出加入反亲和组对话框。
2. 选择反亲和组（仅显示与虚拟机同项目的反亲和组），单击 **_"确定"_** 按钮。

#### 续费
在阿里云、华为云、腾讯云、UCloud、京东云平台上申请的包年包月的虚拟机到期后，如果需要继续使用虚拟机资源，需要在虚拟机资源释放之前进行续费操作。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-续费"_** 菜单项，弹出续费对话框。
2. 选择续费时长，单击 **_"确定"_** 按钮。

#### 自动续费设置

为了避免阿里云、华为云、腾讯云、UCloud、京东云平台上的包年包月虚拟机到期后由于忘记续费而导致虚拟机被释放，建议用户为重要的包年包月虚拟机设置自动续费。

{{% alert title="说明" %}}
阿里云平台按周购买的虚拟机续费周期是一周，按月购买的虚拟机续费周期是一个月，按年购买的虚拟机续费周期是一年；其他平台续费周期均为一个月。后续虚拟机在每次到期之前都会自动续费。

{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"实例设置-自动续费设置"_** 菜单项，弹出设置自动续费对话框。
2. 自动续费：勾选自动续费，单击 **_"确定"_** 按钮，设置自动续费。
3. 取消自动续费：取消勾选自动续费，单击 **_"确定"_** 按钮，取消自动续费。

### 密码密钥

#### 重置密码

该功能用于更新虚拟机上的管理员用户的密码，管理员密码在Linux系统下为root用户的密码、Windows操作系统下为administrator用户的密码。

{{% alert title="注意" color="warning" %}}
- AWS平台的虚拟机不支持重置密码；
- OpenStack、ZStack、DStack、Azure、UCloud平台的虚拟机在运行状态下支持重置密码操作；
- 在{{<oem_name>}}、VMware、HCSO、阿里云、华为云、腾讯云、Google、天翼云平台的虚拟机在关机状态下支持重置密码操作；
- 绑定密钥的虚拟机无法进行重置密码操作。
- 通过ISO启动方式创建的{{<oem_name>}}平台虚拟机不支持重置密码操作。
{{% /alert %}}

**单个虚拟机重置密码**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-重置密码"_** 菜单项，弹出重置密码对话框。
2. 设置管理员密码。
    - 随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。
    - 手工输入：可手动设置管理员密码。
3. 默认勾选“重置密码后自动启动”，可根据需要取消勾选，单击 **_"确定"_** 按钮，完成操作。

**批量重置密码**

批量重置密码选择的虚拟机需要属于同一平台。

1. 在虚拟机列表中选择一个或多个同一平台的虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"密码密钥-重置密码"_** 菜单项，弹出重置密码对话框。
2. 设置管理员密码。
    - 随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。
    - 手工输入：可手动设置管理员密码。
3. 默认勾选“重置密码后自动启动”，可根据需要取消勾选，单击 **_"确定"_** 按钮，完成操作。


{{% alert title="注意" color="warning" %}}
若华为云平台的虚拟机重置密码不生效，原因是虚拟机上未安装一键式重置密码插件，请按照[安装方法](https://support.huaweicloud.com/usermanual-ecs/zh-cn_topic_0068095385.html)安装插件。用户如需在华为云平台使用自定义镜像时，需要在自定义镜像中安装一键式重置密码插件。
{{% /alert %}}

#### 绑定密钥

该功能用于为虚拟机绑定密钥，密钥绑定后用户需要使用私钥登录虚拟机，或通过私钥在云管平台上获取虚拟机密码。在绑定密钥之前请创建密钥。一个虚拟机只支持绑定一个密钥，当绑定密钥后，用户在虚拟机列表的密码列无法直接看到密码信息，需要输入私钥内容获取密码。

{{% alert title="注意" color="warning" %}}
- AWS、天翼云平台的虚拟机不支持绑定密钥。
- ZStack、DStack、Azure平台的虚拟机支持在运行状态绑定密钥。
- OpenStack、HCSO、华为云平台仅新建虚拟机时支持绑定密钥，已创建的虚拟机不支持绑定密钥。
- 通过ISO启动方式创建的{{<oem_name>}}平台虚拟机不支持绑定密钥操作。
- 其他平台的虚拟机需要在关机状态下绑定密钥。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-绑定密钥"_** 菜单项，弹出绑定密钥对话框。
2. 选择密钥对，默认勾选“绑定密钥后自动启动”，可根据需要取消勾选，单击 **_"确定"_** 按钮，绑定密钥的虚拟机需要使用SSH密钥对登录。

#### 解绑密钥
该功能用于将虚拟机与密钥解除绑定。

{{% alert title="注意" color="warning" %}}
OpenStack平台虚拟机解绑密钥后重置密码可能会报错，请手动重置密码。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-解绑密钥"_** 菜单项，弹出绑定密钥对话框。
2. 默认勾选“绑定密钥后自动启动”，可根据需要取消勾选，单击 **_"确定"_** 按钮，完成操作。

#### 设置免密登录

该功能用于将虚拟机设置为能被平台免密登录。虚拟机能被平台免密登录，则要求虚拟机与平台网络通（即通过EIP、NAT网关或SSH代理等方式使虚拟机与平台网络通）以及虚拟机中存在平台的公钥文件。设置免密登录功能仅用于将平台的公钥拷贝到虚拟机中，请先确保虚拟机与平台网络通。

**设置免密登录**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-设置免密登录"_** 菜单项，弹出设置免密登录对话框。
2. 配置以下参数：
    - SSH端口：修改虚拟机的SSH端口，将通过该端口免密登录到虚拟机。
    - 设置方式：支持密钥、密码、脚本等方式将平台的公钥上传到虚拟机上。
    - 当设置方式为“密钥”时，请使用root用户或具有使用sudo免密权限的用户以其私钥，请确保可以通过用户名和私钥通过ssh连接到对应虚拟机，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“密码”时，请使用root用户或具有使用sudo免密权限的用户以其密码，请确保可以通过用户名和密码通过ssh连接到对应虚拟机。单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“脚本”时，请请使用root或具有sudo权限的用户在虚拟机中执行以下脚本，执行完成后，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
3. 若虚拟机可以免密登录，直接单击 **_"关闭"_** 按钮。
4. 若虚拟机仍不可免密登录，请在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“Failed to connect to the host via ssh”，则需要先将该虚拟机通过绑定EIP或NAT网关以及SSH代理等方式，使其与平台网络可通。
    - 如报错原因中提示“Permission denied”，则表示输入的信息错误，可单击 **_"上一步"_** 按钮，修改配置，继续设置并探测。


**批量设置免密登录**

只支持批量为同一项目下的虚拟机设置免密登录。

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"密码密钥-设置免密登录"_** 菜单项，弹出设置免密登录对话框。
2. 配置以下参数：
    - SSH端口：修改虚拟机的SSH端口，将通过该端口免密登录到虚拟机。
    - 设置方式：支持密钥、密码、脚本等方式将平台的公钥上传到虚拟机上。
    - 当设置方式为“密钥”时，请使用root用户或具有使用sudo免密权限的用户以其私钥，请确保可以通过用户名和私钥通过ssh连接到对应虚拟机，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“密码”时，请使用root用户或具有使用sudo免密权限的用户以其密码，请确保可以通过用户名和密码通过ssh连接到对应虚拟机。单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“脚本”时，请请使用root或具有sudo权限的用户在虚拟机中执行以下脚本，执行完成后，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
4. 若虚拟机可以免密登录，直接单击 **_"关闭"_** 按钮。
5. 若虚拟机仍不可免密登录，请在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“Failed to connect to the host via ssh”，则需要先将该虚拟机通过绑定EIP、NAT网关以或SSH代理等方式，使其与平台网络可通。
    - 如报错原因中提示“Permission denied”，则表示输入的信息错误，可单击 **_"上一步"_** 按钮，修改配置，继续设置并探测。

#### 探测免密登录

该功能用于探测虚拟机是否能被平台免密登录。

**探测免密登录**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-探测免密登录"_** 菜单项，弹出探测免密登录对话框。
2. 开始探测免密登录，并支持在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“none publickey”，可通过设置免密登录功能，将虚拟机设置为免密登录状态。
    - 如报错原因中提示“network error”，则需要先将该虚拟机通过绑定EIP或NAT网关以及SSH代理等方式，使其与平台网络可通。

**批量探测免密登录**

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"密码密钥-探测免密登录"_** 菜单项，弹出探测免密登录对话框。
2. 开始探测免密登录，并支持在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“none publickey”，可通过设置免密登录功能，将虚拟机设置为免密登录状态。
    - 如报错原因中提示“network error”，则需要先将该虚拟机通过绑定EIP或NAT网关以及SSH代理等方式，使其与平台网络可通。

### 镜像

#### 保存镜像

**保存本地IDC虚拟机镜像**

将关机状态的虚拟机保存为qcow2格式的镜像文件保存在镜像列表，保存的镜像默认为自定义镜像。目前只支持{{<oem_name>}}平台和VMware平台。

1. ​单击{{<oem_name>}}平台和VMware平台“关机”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"镜像-保存镜像"_** 菜单项，弹出保存镜像对话框。
2. 选择镜像类别、输入镜像名称，选择是否勾选“保存镜像后自动启动”，单击 **_"确定"_** 按钮，若勾选保存镜像后自动启动，则当虚拟机保存镜像文件后，虚拟机将启动。
    - 创建系统镜像：仅将虚拟机的系统盘保存为系统镜像，该镜像只占一个镜像配额。
    - 创建主机镜像：选择该项后，将虚拟机的系统盘和数据盘保存为主机镜像，主机镜像占的镜像配额等于虚拟机的硬盘数量。

**保存私有云虚拟机镜像**

将私有云平台的镜像保存到对应私有云平台的自定义镜像列表，在平台的镜像列表中不可见，用户可在创建对应平台的虚拟机时的私有云自定义镜像列表中使用该镜像创建相同配置的虚拟机，目支持HCSO。

1. 单击私有云平台“关机”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"镜像-保存镜像"_** 菜单项，弹出保存镜像对话框。
2. 输入镜像名称，选择是否勾选“保存镜像后自动启动”，单击 **_"确定"_** 按钮，若勾选保存镜像后自动启动，则当虚拟机保存镜像文件后，虚拟机将启动。

**保存公有云虚拟机镜像**

将公有云平台的镜像保存到对应公有云平台的自定义镜像列表。在平台的镜像列表中不可见，用户可在创建对应平台的虚拟机时的公有云自定义镜像列表中使用该镜像创建相同配置的虚拟机。目前支持阿里云、腾讯云、华为云、AWS、Azure、Google。

1. 单击公有云平台“关机”状态的虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"镜像-保存镜像"_** 菜单项，弹出保存镜像对话框。
2. 输入镜像名称，选择是否勾选“保存镜像后自动启动”，单击 **_"确定"_** 按钮，若勾选保存镜像后自动启动，则当虚拟机保存镜像文件后，虚拟机将启动。

#### 挂载ISO

该功能用于为虚拟机的虚拟光驱挂载ISO镜像，仅{{<oem_name>}}平台上的虚拟机支持挂载ISO操作。如需使用ISO文件安装操作系统，请在挂载ISO镜像后，在修改属性中将启动介质设置为光驱。

{{% alert title="注意" color="warning" %}}
通过挂载ISO安装Windows操作系统的虚拟机，安装完成后，还需要安装Virtio驱动，驱动可在镜像市场-ISO中获取。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"镜像-挂载ISO"_** 菜单项，弹出挂载ISO对话框。
2. 选择ISO镜像，若列表中没有ISO镜像，请先在系统镜像列表中上传ISO镜像或导入镜像市场中的ISO镜像。
3. 单击 **_"确定"_** 按钮，完成挂载ISO操作。

#### 卸载ISO

该功能用于卸载虚拟机的虚拟光驱上挂载的ISO镜像。仅{{<oem_name>}}平台上的虚拟机支持卸载ISO操作。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"镜像-卸载ISO"_** 菜单项，弹出操作确认对话框。
2. 单击 **_"确定"_** 按钮，完成卸载ISO操作。

### 网络安全

#### 关联安全组

安全组是一种虚拟的包过滤防火墙，通过设置安全组规则来控制关联的虚拟机是否可以被访问，以及虚拟机可访问的外部资源等。在为虚拟机绑定安全组之前请先在网络-安全组页面创建安全组规则。批量关联安全组操作支持选择不同平台上的虚拟机。

**单个虚拟机关联安全组**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"网络安全-关联安全组"_** 菜单项，弹出关联安全组对话框。
2. 在关联安全组对话框中支持关联或取消关联安全组。
    - 关联安全组：选择要绑定的安全组，最多支持5个。如没有符合需求的安全组，可单击“新建安全组”超链接，在弹出的新建安全组页面配置相关参数，单击 “确定” 按钮，创建安全组。
    - 取消关联安全组：取消选择安全组，至少保留一个安全组。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量关联安全组**

1. 在虚拟机列表中选择一个或多个虚拟机，单击 **_"批量操作"_** 按钮，选择下拉菜单 **_"网络安全-关联安全组"_** 菜单项，弹出关联安全组对话框。
2. 在关联安全组对话框中支持关联或取消关联安全组。
    - 关联安全组：选择要绑定的安全组，最多支持5个。如没有符合需求的安全组，可单击“新建安全组”超链接，在弹出的新建安全组页面配置相关参数，单击 “确定” 按钮，创建安全组。
    - 取消关联安全组：取消选择安全组，至少保留一个安全组。
3. 单击 **_"确定"_** 按钮，完成操作。

#### 绑定弹性公网IP

弹性公网IP是一种NAT IP，通过与虚拟机绑定，实现虚拟机与公网之间的通信。

{{% alert title="注意" color="warning" %}}

- 目前ZStack、OpenStack平台的虚拟机在绑定弹性公网IP时不支持创建弹性公网IP，且不支持绑定属于同一IP子网的弹性公网IP；
- VMware平台的虚拟机不支持绑定弹性公网IP。
- 仅{{<oem_name>}}平台VPC网络的虚拟机支持绑定弹性公网IP。

{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"网络安全-绑定弹性公网IP"_** 菜单项，弹出绑定弹性公网IP对话框。
2. 配置以下参数
    - 若绑定方式选择“新建”弹性公网IP，
        - 当选择{{<oem_name>}}平台时配置以下参数：
            - 线路类型：可根据需求创建对应线路类型的EIP。
            - 网络计费方式：设置弹性公网IP的计费方式，只支持按带宽计费。
                - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
            - 带宽：设置带宽大小。
        - 当选择公有云平台时配置以下参数：
            - 网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
                - 按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。
                - 按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。
            - 带宽：设置带宽大小。
{{% alert title="注意" color="warning" %}}
        腾讯云和Azure不支持按固定带宽计费。
{{% /alert %}}
    - 若绑定方式选择“绑定已有”，请确保在弹性公网IP页面已存在对应平台的弹性公网IP，选择弹性公网IP。
3. 单击 **_"确定"_** 按钮。

#### 解绑弹性公网IP
该功能用于解除虚拟机与弹性公网IP的绑定关系，释放弹性公网IP资源，释放后的弹性公网IP可以被其他虚拟机使用。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"网络安全-解绑弹性公网IP"_** 菜单项，弹出解绑弹性公网IP对话框。
2. 单击 **_"确定"_** 按钮，完成操作。

#### 公网IP转EIP

该功能用于将虚拟机绑定的公网IP转换为弹性公网IP。

{{% alert title="说明" %}}
- 仅阿里云、腾讯云支持该功能。
- 只有绑定公网IP的公有云虚拟机处于运行或关闭状态时才支持将公网IP转换为弹性公网IP。
- 绑定公网IP的虚拟机没有绑定EIP。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"网络安全-公网IP转EIP"_** 菜单项，弹出公网IP转EIP对话框。
2. 单击 **_"确定"_** 按钮，完成操作。 

#### 设置源/目标检查

源/目标检查即检查虚拟机接收或发送的流量的源/目标地址是否为虚拟机。启用检查时，当源/目标地址不是虚拟机时，则丢弃不处理；当虚拟机作为NAT、路由器、防火墙等使用时必须禁用源/目标检查。

仅{{<oem_name>}}平台的虚拟机支持设置源/目标检查且默认启用源/目标检查。

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"网络安全-设置源/目标检查"_** 菜单项，弹出设置源/目标检查对话框。
2. 选择开启或关闭源/目标检查，单击 **_"确定"_** 按钮，完成操作。

#### 补IP

当VMware虚拟机由于一些原因（如关机状态同步、未安装agent等）未同步到IP地址时，虚拟机列表的IP地址字段显示为"-"，此时支持为VMware虚拟机补IP。补充的IP地址必须与虚拟机的实际IP一致。

1. 在虚拟机列表中，当VMware平台虚拟机IP地址列为空时，单击IP地址列的 **_"可补IP"_** 按钮，弹出补充IP对话框。
2. 设置IP地址，单击 **_"确定"_** 按钮。

### 高可用

仅{{<oem_name>}}平台上的基于本地存储创建的虚拟机支持高可用功能，通过为虚拟机创建备份机来实现高可用，虚拟机与备份机之间互为主备且数据保持实时同步，当主虚拟机故障时，将会自动切换到备份机，快速恢复业务，减少因为虚拟机故障造成的业务宕机时间，同时将会再次为虚拟机创建可用的备份机，使其一直保持高可用的状态。

{{% alert title="注意" color="warning" %}}
当创建备份机失败或切换备份机失败时，支持手动重试。
{{% /alert %}}

#### 添加备份机

该功能用于为使用本地存储的虚拟机在其它宿主机上创建备份机，创建的备份机与虚拟机配置相同，互为主备，实时保持数据同步等。虚拟机列表中只显示主虚拟机的信息，不显示备份机信息。

{{% alert title="注意" color="warning" %}}
- 虚拟机和备份机不可以位于同一宿主机。
- 虚拟机添加备份机之后不支持调整配置、创建快照、迁移功能。
- 已经创建快照的虚拟机，添加备份机且切换到备份机后，原有快照不可用。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"高可用-添加备份机"_** 菜单项，弹出添加备份机对话框。
2. 选择备份机的宿主机，单击 **_"确定"_** 按钮。
3. 虚拟机名称右侧将出现![](../../../images/computing/HA.png)的图标。

#### 删除备份机
该功能用于删除虚拟机的备份机。

1. 单击名称侧带有![](../../../images/computing/HA.png)图标的虚拟机的 **_"更多"_** 按钮，选择下拉菜单 **_"高可用-删除备份机"_** 菜单项，弹出添加备份机对话框。
2. 若备份机所在宿主机离线，可勾选“强制清除备份机记录”。
3. 单击 **_"确定"_** 按钮，删除备份机。

#### 迁移

该功能用于将虚拟机迁移到其他宿主机上面。当未指定宿主机时，系统将自动选择宿主机。

{{% alert title="注意" color="warning" %}}
- 迁移要求环境中至少存在处于同一二层网络的两台{{<oem_name>}}宿主机，且要求两台宿主机的CPU型号和微码相同，若宿主机CPU型号不一致仍想继续迁移，可开启跳过CPU检查，平台将会尽力而为的进行迁移，但是迁移完成后，可能会存在虚拟机在目标宿主机上无法正常运行的情况。
    ```
    # 查看CPU型号
    $ lscpu | grep "Model name"
    # 查看微码
    $ cat /proc/cpuinfo  | grep microcode
    ```
    ![](../../../images/computing/cpuinfo.png)
- 高可用的虚拟机不支持迁移。
- 挂载了GPU设备或光驱设备的虚拟机不支持迁移。
{{% /alert %}}

**单个虚拟机迁移**

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"高可用-迁移"_** 菜单项，弹出迁移对话框。
2. 配置以下参数：
    - 强制迁移：若宿主机宕机，且虚拟机使用共享存储，可勾选“强制迁移”。
    - 跳过CPU检查：虚拟机迁移时，要求目的宿主机与虚拟机所在宿主机的CPU型号和微码相同，若宿主机CPU型号不一致仍想继续迁移，可开启跳过CPU检查，系统将会尽力而为的进行惹迁移，但是迁移完成后，可能会存在虚拟机在目标宿主机上无法正常运行的情况。
    - 宿主机：选择目标宿主机，也可留空，留空将由系统自动选择宿主机。平台会预先调度过滤出符合迁移条件的宿主机，如没有满足条件的宿主机，请检查在同一二层网络的宿主机上是否有可用的CPU、内存、存储，以及CPU型号和微码是否一样，若不一样，可先跳过CPU检查后尝试迁移等。
3. 单击 **_"确定"_** 按钮，将虚拟机迁移到其他宿主机上面。

**批量迁移**

可以选择在不同宿主机的虚拟机迁移到同一个宿主机上。

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"迁移"_** 菜单项项，弹出迁移对话框。
2. 配置以下参数：
    - 强制迁移：若宿主机宕机，且虚拟机使用共享存储，可勾选“强制迁移”。
    - 跳过CPU检查：虚拟机迁移时，要求目的宿主机与虚拟机所在宿主机的CPU型号和微码相同，若宿主机CPU型号不一致仍想继续迁移，可开启跳过CPU检查，系统将会尽力而为的进行惹迁移，但是迁移完成后，可能会存在虚拟机在目标宿主机上无法正常运行的情况。
    - 宿主机：选择目标宿主机，也可留空，留空将由系统自动选择宿主机。平台会预先调度过滤出符合迁移条件的宿主机，如没有满足条件的宿主机，请检查在同一二层网络的宿主机上是否有可用的CPU、内存、存储，以及CPU型号和微码是否一样，若不一样，可先跳过CPU检查后尝试迁移等。
3. 单击 **_"确定"_** 按钮，将虚拟机迁移到其他宿主机上面。

#### 快速恢复
该功能用于使宿主机离线的虚拟机可以正常使用。

{{% alert title="注意" color="warning" %}}
- 仅{{<oem_name>}}平台上虚拟机支持该操作。
- 只有使用共享存储且宿主机离线才可用
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"高可用-快速恢复"_** 菜单项，弹出迁移对话框。
2. 单击 **_"确定"_** 按钮，将虚拟机快速恢复。


### 删除

#### 设置删除保护

该功能用于设置虚拟机的删除保护。当虚拟机启用删除保护后，虚拟机无法被删除；当虚拟机禁用删除保护后，虚拟机才可以被删除。

**单个虚拟机设置删除保护**

1. 禁用删除保护：
    - 单击虚拟机名称右侧带有![](../../../images/computing/delprotect1.png)图标时，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"禁用"删除保护，单击 **_"确定"_** 按钮。
2. 启用删除保护：
    - 当虚拟机名称右侧不带![](../../../images/computing/delprotect1.png)图标时，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"启用"删除保护，单击 **_"确定"_** 按钮。

**批量设置删除保护**

批量设置删除保护操作支持选择不同平台的虚拟机。

1. 禁用删除保护：
    - 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"禁用"删除保护，单击 **_"确定"_** 按钮，批量为虚拟机禁用删除保护。
2. 启用删除保护：
    - 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"启用"删除保护，单击 **_"确定"_** 按钮，批量为虚拟机启用删除保护。


#### 删除

该功能用于删除虚拟机，当虚拟机名称项右侧有![](../../../images/computing/delprotect1.png)图标，表示该虚拟机启用了删除保护，无法删除虚拟机。如需要删除虚拟机，则需要先禁用删除保护再删除虚拟机

批量删除虚拟机操作支持选择不同平台的虚拟机。

{{% alert title="注意" color="warning" %}}
- 若虚拟机所在的宿主机状态异常，即使禁用删除保护也无法删除虚拟机。
- 若宿主机已经下线无法恢复时，需要管理员在控制节点使用climc的server-purge命令删除虚拟机记录。[可参考FAQ手册中的如何清理一台已经下线的宿主机上面的虚拟机的记录？](../../../../faq/heterresource/)
- 当机器在云上删除后，默认情况下在同步云账号时会自动删除平台上的对应虚拟机。若在{{<oem_name>}}平台上虚拟机状态为操作失败等，即使在云上已经删除，云账号同步时也不会自动删除，需要手动删除虚拟机。
{{% /alert %}}

##### 删除虚拟机

{{% alert title="注意" color="warning" %}}
- 阿里云、腾讯云、华为云、AWS、Azure、Google、Zstack、Dstack、OpenStack、HCSO、{{<oem_name>}}等平台支持删除虚拟机时同时删除快照、后挂载的数据盘、EIP；
- 华为云、HCSO删除虚拟机时必须勾选删除快照。
- {{<oem_name>}}平台删除虚拟机时，若磁盘时ceph盘则必须同时删除快照。若磁盘是本地磁盘，则必须勾选同时删除后挂载的数据盘。
{{% /alert %}}

1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-删除"_** 菜单项，弹出操作确认对话框。
2. 支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。
3. 单击 **_"确定"_** 按钮，完成操作。
4. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。

##### 批量删除虚拟机
{{% alert title="注意" color="warning" %}}
- 阿里云、腾讯云、华为云、AWS、Azure、Google、Zstack、Dstack、OpenStack、HCSO、{{<oem_name>}}等平台支持删除虚拟机时同时删除快照、后挂载的数据盘、EIP；
- 华为云、HCSO删除虚拟机时必须勾选删除快照。
- {{<oem_name>}}平台删除虚拟机时，若磁盘时ceph盘则必须同时删除快照。若磁盘是本地磁盘，则必须勾选同时删除后挂载的数据盘。
{{% /alert %}}

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。
3. 单击 **_"确定"_** 按钮，完成操作。
4. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。

## 查看虚拟机详情

该功能用于查看虚拟机详细信息以及安全组、网络、磁盘、监控、告警及操作日志等信息。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 详情页面顶部菜单项支持对虚拟机进行管理操作等。
3. 查看以下信息。
    - 基本信息：包括ID、名称、状态、域、项目、主机名、CPU架构、标签、agent安装状态、关联密钥、平台、计费方式、区域、可用区、云账号、创建时间、更新时间、备注；
    - 配置信息：包括操作系统、IP地址、MAC地址、系统镜像、宿主机、安全组、VPC、CPU、内存、系统盘、数据盘、ISO、GPU、备份机的宿主机等；
    - 其他设置：支持开启或关闭删除保护。

## 查看安全组信息

该功能用于查看虚拟机绑定的安全组信息。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“安全组”页签，进入安全组页面。
3. 显示虚拟机绑定的安全组列表信息并支持安全组进行管理操作，具体操作使用方法请参考[安全组](../../network/secgroup)。

## 虚拟机网卡管理

该功能用于查看虚拟机的网卡信息，并支持针对网卡进行管理操作。

### 添加网卡

该功能用于为虚拟机添加网卡，最多可添加8个网卡，目前仅{{<oem_name>}}平台的虚拟机支持添加网卡功能。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“网络”页签，进入网络页面。
3. 单击网卡列表上方 **_"添加网卡"_** 按钮，弹出添加网卡对话框。
4. 设置VPC和IP子网，如需指定静态IP，可单击 **_"手动配置IP"_** 按钮，设置IP地址，单击 **_"确定"_** 按钮。

### 修改带宽

该功能用于修改网卡的带宽限制。目前仅支持{{<oem_name>}}平台、VMware平台、ZStack平台、OpenStack平台。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“网络”页签，进入网络页面。
3. 单击网卡右侧操作列 **_"修改带宽"_** 按钮，弹出修改带宽对话框。
4. 设置带宽，0表示无限制，取值范围为0~10000的整数。单击 **_"确定"_** 按钮。
5. 若开启了调整配置的工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交修改带宽工单，等待审批通过后才会成功修改带宽。

### 更换IP

该功能用于更换虚拟机的IP地址，支持在IP子网中动态分配IP地址或手动指定IP子网内的IP地址。目前仅支持{{<oem_name>}}平台、VMware平台。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“网络”页签，进入网络页面。
3. 单击网卡右侧操作列 **_"更换IP"_** 按钮，弹出更换IP对话框。
4. 配置以下参数：
    - IP子网：选择IP子网，如需指定静态IP，可单击 **_"手动配置IP"_** 按钮，设置IP地址，
    - 同时重启网卡：默认勾选“同时重启网卡”，更换IP需要重启网卡才能生效。
5. 单击 **_"确定"_** 按钮，完成操作。

### 卸载网卡

该功能用于卸载虚拟机上的网卡，卸载时需要按照顺序卸载，只允许卸载最后一块网络，即序号最大的网卡支持卸载，所有网卡均可以被卸载。目前仅支持{{<oem_name>}}平台。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“网络”页签，进入网络页面。
3. 单击最后一块网卡右侧操作列 **_"卸载"_** 按钮，弹出卸载网卡对话框。
4. 单击 **_"确定"_** 按钮，完成操作。

## 查看弹性公网IP信息

该功能用于查看虚拟机绑定的弹性公网IP信息。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“弹性公网IP”页签，进入弹性公网IP页面。
3. 查看虚拟机绑定的弹性公网IP的名称、状态、标签、IP、带宽、计费方式、平台、项目、区域等。支持自定义数据列功能。

## 查看磁盘信息

该功能用于查看虚拟机上的磁盘信息。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“磁盘”页签，进入磁盘页面。
3. 查看虚拟机磁盘的序号、磁盘名称、大小、驱动、缓存模式、状态、存储类型、磁盘类型等。支持自定义数据列功能。

## 查看快照信息

该功能用于查看虚拟机创建的硬盘快照和主机快照信息，支持对快照进行管理。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“快照”页签，进入快照页面。
3. 默认查看硬盘快照，支持回滚硬盘以及删除等操作。
4. 单击“主机快照”页签，查看主机快照，支持删除操作。

## 查看虚拟机监控信息

该功能用于查看虚拟机的监控信息，并支持基于监控信息设置告警。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“监控”页签，进入监控页面。
3. 默认查看以下监控信息：
    - 基础监控：默认获取的监控信息。
        - 支持查看近1小时、近1天、近1周、近1月、近3月、近6月的性能监控信息，支持设置时间粒度，时间粒度大小与查看的时长有关。
        - 监控指标包括CPU使用率、内存使用率、网络入流量、网络出流量、磁盘使用率、磁盘读速率、磁盘写速率，其中内存使用率和磁盘使用率指标需要安装Agent后查看。
    - Agent监控：虚拟机安装Agent后获取的监控信息，比基础监控多了磁盘使用率指标。相较于基础监控，Agent监控获取都的监控数据更加准确。
### 安装Agent

该功能用于给虚拟机安装Agent。

安装agent前提条件：

- 虚拟机是Linux、X86 Windows操作系统；
- X86 Windows虚拟机处于关机状态，Linux虚拟机状态不限；
- 在{{<oem_name>}}平台VPC内的虚拟机可以直接安装agent；非{{<oem_name>}}平台的虚拟机要求所在VPC或IP子网中存在SSH代理节点；
- 虚拟机可以被平台免密登录；
- 在{{<oem_name>}}平台VPC内的虚拟机可以直接安装agent；

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“监控”页签，进入监控页面。
3. 单击 **_"安装Agent"_** 按钮，弹出安装Agent按钮。
4. 开始探测虚拟机的免密登录状态。
    - 当虚拟机可以免密登录时，单击 **_"确定"_** 按钮，安装Agent。
    - 当虚拟机不可免密登录时，请先将虚拟机设置为免密登录状态。，请先点击列表操作列 **_"查看"_** 按钮，查看探测免密登录失败的具体原因。
        - 如报错原因中提示“none publickey”，可通过设置免密登录功能，将虚拟机设置为免密登录状态。设置免密登录方式配置参数如下：
            - 设置方式：支持密钥、密码、脚本等方式将平台的公钥上传到虚拟机上。
            - 当设置方式为“密钥”时，请使用root用户或具有使用sudo免密权限的用户以其私钥，请确保可以通过用户名和私钥通过ssh连接到对应虚拟机，单击 **_"确定"_** 按钮，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
            - 当设置方式为“密码”时，请使用root用户或具有使用sudo免密权限的用户以其密码，请确保可以通过用户名和密码通过ssh连接到对应虚拟机。单击 **_"确定"_** 按钮，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
            - 当设置方式为“脚本”时，请请使用root或具有sudo权限的用户在虚拟机中执行以下脚本，执行完成后，单击 **_"确定"_** 按钮，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
        - 如报错原因中提示“network error”，则需要返回上一步选择其他虚拟机，或为该虚拟机通过绑定EIP或NAT网关等方式，使其与平台网络可通。
{{% alert title="说明" %}}
当Agent安装失败后，可以将鼠标移到到“安装失败，可尝试重新安装”上，将会展示Agent安装失败的具体原因。
{{% /alert %}}

## 虚拟机告警设置

该功能用于针对虚拟机的监控指标设置告警，当超过告警条件后将通过邮件通知告警接收人。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“告警”页签，进入告警页面。
3. 支持对告警进行管理操作。
    - 新建告警：可根据实际情况新建多个告警条件。
        - 单击列表上方 **_"新建"_** 按钮，弹出新建告警对话框。
        - 指标：支持针对CPU使用率、内存利用率、网络入流量、网络出流量、磁盘读速率、磁盘写速率等参数设置告警条件等。
        - 查询周期：设置查询告警条件的周期时间。
        - 比较运算符、阈值：设置告警条件的阈值，当虚拟机的监控指标数据超过或低于告警条件中指标的阈值时，将触发告警。
        - 告警级别：包括普通（normal）、重要（important）、致命（fatal）。
        - 告警方式：目前仅支持邮件告警。
        - 告警接收人：可选择同项目内的用户或域管理员、系统管理员角色的用户。
        - 设置完成后，单击 **_"确定"_** 按钮。
    - 修改告警：除指标之外其它参数都可以修改。
    - 删除告警：支持删除单个告警条件或批量删除告警条件。
        - 删除单个：单击操作列 **_删除_** 按钮，在弹出操作确认对话框单击 **_"确定"_** 按钮。
        - 批量删除：在列表中选择一个或多个告警条件，单击左上角 **_删除_** 按钮，在弹出的操作确认对话框中单击 **_"确定"_** 按钮，批量删除告警条件。

## 查看虚拟机操作日志

该功能用于查看虚拟机相关操作的日志信息。

1. 在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。
2. 单击“操作日志”页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。

## 查看虚拟机多层级组织架构

该功能用于通过项目标签进行多个层级的虚拟机资源过滤及展示。

1. 在虚拟机页面，单击搜索框左侧图标，展开层级项目。
2. 单击右上角设置图标，进入配置层级页面。
3. 单击“添加层级”，可添加多个层级，每个层级选择好项目标签后，单击“确定”按钮。
4. 新建项目标签的具体操作方法请参考[项目](../../../iam/keystone/project)。