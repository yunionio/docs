---
title: "透传设备"
weight: 3
description: 透传设备包括GPU、NPU、USB、SR-IOV、NIC等类型的设备，其中GPU设备适用于图形处理、深度计算等应用场景。 
---

透传设备包括GPU、USB、NPU、SR-IOV、NIC等类型的设备，GPU设备主要用于图形处理、深度计算等应用场景。NPU设备主要用于神经网络计算任务等应用场景。云管平台提供设备透传功能支持在虚拟机上使用透传设备。当用户需要使用透传设备时，为虚拟机绑定GPU卡、NPU卡等，目前虚拟机只支持绑定虚拟机所在宿主机上的透传设备。当用户不再需要使用透传设备时，可以取消虚拟机与透传设备的绑定，透传设备可以分配给宿主机上的其他虚拟机使用。对于上述类型之外的设备通过自定义 PCI 设备类型的方式来支持。

透传设备页面仅显示宿主机上的GPU、NPU等，物理机上的GPU、NPU设备不会在此显示，只有当物理机转换成宿主机后，GPU、NPU等透传设备才会在此页面显示。

SR-IOV网卡是一种基于物理硬件的虚拟化技术，可以提高物理 I/O 设备（常见的是网络适配器）的性能与可扩展性。SR-IOV网卡允许在虚拟机之间高效共享 PCIe 设备，由于 SR-IOV 技术是基于硬件实现的，可以使虚拟机获得与宿主机媲美的 I/O 性能。

**入口**：在云管平台单击左上角![](../../../images/intro/nav.png)导航菜单，在弹出的左侧菜单栏中单击 **_"主机/基础资源/透传设备"_** 菜单项，进入透传设备页面。

  ![](../../../images/computing/gpu1.png)


## 更新设备类型

该功能用于对GPU-VGA类型和GPU-HPC两种类型之间做更新转换。

{{% alert title="说明" %}}
- GPU-HPC: 高性能计算卡（High-Performance Computing），主要用于进行科学计算、数据分析、机器学习等需要大规模并行计算的任务。

- GPU-VGA: 视频图形处理卡（Video Graphics Array），用于图形渲染和显示的目的。

- GPU-VGA 类型的 GPU 卡透传给虚机使用时，不在提供模拟的 VGA 设备，需要在镜像内提前安装好显卡驱动。
{{% /alert %}}

1. 单击透传设备右侧操作列 **_"更新设备类型"_** 按钮，弹出更新设备类型对话框。
2. 选择需要更新的设备类型，单击 **_"确定"_** 按钮，完成操作。

## 关联虚拟机

该功能用于将GPU、NPU等透传设备绑定到虚拟机使用，也支持在创建虚拟机时绑定GPU、NPU等透传设备。要求关联的虚拟机与GPU、NPU等透传设备在同一台宿主机，且虚拟机处于关机状态。

1. 单击透传设备右侧操作列 **_"关联虚拟机"_** 按钮，弹出关联虚拟机对话框。
2. 选择宿主机上的虚拟机，默认勾选设置成功后自动启动，即关联虚拟机后自动启动虚拟机。
3. 单击 **_"确定"_** 按钮，完成操作。

## 取消关联虚拟机

该功能用于取消虚拟机与GPU、NPU等透传设备的绑定，取消关联虚拟机的GPU、NPU等透传设备可以分配给其他虚拟机使用。虚拟机在关机状态下才可以取消关联。

**取消关联虚拟机**

1. 单击透传设备右侧操作列 **_"取消关联虚拟机"_** 按钮，弹出操作确认对话框。
2. 默认勾选设置成功后自动启动，即取消关联虚拟机后，自动启动虚拟机。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量取消关联虚拟机**

1. 在透传设备列表中选择一个或多个已关联虚拟机的透传设备，单击列表上方 **_"取消关联虚拟机"_** 按钮，弹出操作确认对话框。
2. 默认勾选设置成功后自动启动，即取消关联虚拟机后，自动启动虚拟机。
3. 单击 **_"确定"_** 按钮，完成操作。

## 设置预留资源

该功能用于在GPU卡所在的宿主机上为GPU卡预留资源。其他透传设备不支持。

{{% alert title="说明" %}}
GPU卡预留的资源是宿主机CPU、内存、存储超售后的预留的资源。
{{% /alert %}}

**单个GPU卡预留资源**

1. 单击透传设备右侧操作列 **_"设置预留资源"_** 按钮，弹出设置预留资源对话框。
2. 设置预留宿主机资源，分别设置CPU、内存、硬盘大小，单击 **_"确定"_** 按钮。

**批量预留资源**

该功能用于批量为GPU卡预留相同的资源。

1. 在列表中选择一个或多个透传设备，单击列表上方 **_"设置预留资源"_** 按钮，弹出设置预留资源对话框。
2. 设置预留宿主机资源，分别设置CPU、内存、硬盘大小，单击 **_"确定"_** 按钮。

## 查看透传设备详情

该功能用于查看透传设备的详细信息。

1. 在透传设备页面，单击透传设备名称项，进入透传设备详情页面。
2. 在详情页面顶部菜单项支持对透传设备进行管理操作。
3. 查看以下信息：
   - 基本信息：包括云上ID、ID、名称、状态、域、项目、设备型号、设备类型、所在宿主机、关联虚拟机、创建时间、更新时间、备注。
   - 其他信息：包括PCI_BUS_ID。

### 查看操作日志

该功能用于查看透传设备相关操作的日志信息。

1. 在透传设备详情页面，单击“操作日志”页签，进入操作日志页面。
    - 加载更多日志：列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 **_"加载更多"_** 按钮，获取更多日志信息。
    - 查看日志详情：单击操作日志右侧操作列 **_"查看"_** 按钮，查看日志的详情信息。支持复制详情内容。
    - 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。
    - 导出日志：目前仅支持导出本页显示的日志。单击右上角![](../../../images/system/download.png)图标，在弹出的导出数据对话框中，设置导出数据列，单击 **_"确定"_** 按钮，导出日志。

## 自定义透传设备类型

{{<oem_name>}}平台已经支持透传 GPU、NPU、USB、SR-IOV、NIC等类型的设备，该功能用于让{{<oem_name>}}能够探测到这些类型的透传设备，并且能够分配给虚拟机使用。

{{% alert title="说明" %}}

只有绑定了宿主机的透传设备才会展示在透传设备列表。

{{% /alert %}}

  ![](../../../images/computing/pci.png)

1. 在透传设备页面，单击顶部“透传设备类型”页签，单击列表上方 **_"新建"_** 按钮，进入新建透传设备类型页面。
2. 配置以下参数：
     - 设备类型：设备的类型，如GPU、NPU、USB等。
     - 设备型号：设备的型号。
     - 设备VendorID：设备的VendorID，添加自定义PCI设备类型之前需要获取。方法请参考[自定义PCI设备类型](../../../../function_principle/onpremise/vminstance/passthrough/custom-pci-devices/)
     - 设备DeviceID：设备的DeviceID，添加自定义PCI设备类型之前需要获取。方法请参考[自定义PCI设备类型](../../../../function_principle/onpremise/vminstance/passthrough/custom-pci-devices/)
     - 宿主机：选择宿主机后，相应宿主机会自动上报相应透传设备，未选择设备需重启host服务生效。
     - 热插拔：默认关闭，透传设备是否支持热插拔由设备本身决定，验证后再选择是否启用热插拔。
3. 单击 **_"确定"_** 按钮，完成操作。





