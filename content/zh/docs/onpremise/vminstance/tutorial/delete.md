---
title: "删除"
date: 2019-07-19T17:32:09+08:00
weight: 20
description: >
  介绍如何删除虚拟机。
---

## Web界面操作

### 设置删除保护

该功能用于设置虚拟机的删除保护。当虚拟机启用删除保护后，虚拟机无法被删除；当虚拟机禁用删除保护后，虚拟机才可以被删除。

**单个虚拟机设置删除保护**

1. 禁用删除保护：
    - 单击虚拟机名称右侧带有![](../../../images/delprotect1.png)图标时，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"禁用"删除保护，单击 **_"确定"_** 按钮。
2. 启用删除保护：
    - 当虚拟机名称右侧不带![](../../../images/delprotect1.png)图标时，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"启用"删除保护，单击 **_"确定"_** 按钮。

**批量设置删除保护**

批量设置删除保护操作支持选择不同平台的虚拟机。

1. 禁用删除保护：
    - 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"禁用"删除保护，单击 **_"确定"_** 按钮，批量为虚拟机禁用删除保护。
2. 启用删除保护：
    - 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置删除保护"_** 菜单项，弹出设置删除保护对话框。
    - 选择"启用"删除保护，单击 **_"确定"_** 按钮，批量为虚拟机启用删除保护。


### 删除

该功能用于删除虚拟机，当虚拟机名称项右侧有![](../../../images/delprotect1.png)图标，表示该虚拟机启用了删除保护，无法删除虚拟机。如需要删除虚拟机，则需要先禁用删除保护再删除虚拟机。若

批量删除虚拟机操作支持选择不同平台的虚拟机。

{{% alert title="注意" color="warning" %}}
- 若虚拟机所在的宿主机状态异常，即使禁用删除保护也无法删除虚拟机。
- 若宿主机已经下线无法恢复时，需要管理员在控制节点使用climc的server-purge命令删除虚拟机记录。具体请参考[清除虚拟机记录]({{< relref "../faq/purge" >}})
- {{<oem_name>}}等平台支持删除虚拟机时同时删除快照、后挂载的数据盘、EIP；
- {{<oem_name>}}平台删除虚拟机时，若磁盘时ceph盘则必须同时删除快照。若磁盘是本地磁盘，则必须勾选同时删除后挂载的数据盘。
{{% /alert %}}

#### 删除虚拟机


1. 在虚拟机页面，单击虚拟机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"删除-删除"_** 菜单项，弹出操作确认对话框。
2. 支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。
3. 单击 **_"确定"_** 按钮，完成操作。
4. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。

#### 批量删除虚拟机

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"删除"_** 菜单项，弹出操作确认对话框。
2. 支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。
3. 单击 **_"确定"_** 按钮，完成操作。
4. 若开启了工单，则还需要填入申请原因，单击 **_"提交工单"_** 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。



## Climc命令行操作

### 删除

```bash
# 删除至回收站
$ climc server-delete <server_id>

# 彻底删除
$ climc server-delete -f <server_id>
```

